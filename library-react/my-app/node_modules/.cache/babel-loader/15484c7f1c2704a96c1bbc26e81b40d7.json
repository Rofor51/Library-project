{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray2 = require('babel-runtime/helpers/slicedToArray');\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _AuthService = require('./AuthService');\n\nvar _AuthService2 = _interopRequireDefault(_AuthService);\n\nvar _OktaContext = require('./OktaContext');\n\nvar _OktaContext2 = _interopRequireDefault(_OktaContext);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar Security = function Security(props) {\n  var initialAuthService = (0, _react.useMemo)(function () {\n    // don't keep spawning new service instances if this component rerenders\n    return props.authService || new _AuthService2.default(props);\n  }, [props]);\n\n  var _useState = (0, _react.useState)(initialAuthService),\n      _useState2 = (0, _slicedToArray3.default)(_useState, 1),\n      authService = _useState2[0];\n\n  var _useState3 = (0, _react.useState)(authService.getAuthState()),\n      _useState4 = (0, _slicedToArray3.default)(_useState3, 2),\n      authState = _useState4[0],\n      setAuthState = _useState4[1];\n\n  (0, _react.useEffect)(function () {\n    var unsub = authService.on('authStateChange', function () {\n      setAuthState(authService.getAuthState());\n    });\n\n    if (!authService._oktaAuth.token.isLoginRedirect()) {\n      // Trigger an initial change event to make sure authState is latest when not in loginRedirect state\n      authService.updateAuthState();\n    }\n\n    return unsub;\n  }, [authService]);\n  return _react2.default.createElement(_OktaContext2.default.Provider, {\n    value: {\n      authService: authService,\n      authState: authState\n    }\n  }, props.children);\n};\n/*\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\n\nexports.default = Security;","map":{"version":3,"sources":["../src/Security.js"],"names":["Security","initialAuthService","props","AuthService","authService","authState","setAuthState","unsub","children"],"mappings":";;;;;;;;;;AAYA,IAAA,MAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;;;AACA,IAAA,YAAA,GAAA,OAAA,CAAA,eAAA,CAAA;;;;AACA,IAAA,YAAA,GAAA,OAAA,CAAA,eAAA,CAAA;;;;;;;;;;AAEA,IAAMA,QAAAA,GAAW,SAAXA,QAAW,CAAA,KAAA,EAAW;AAE1B,MAAMC,kBAAAA,GAAqB,CAAA,GAAA,MAAA,CAAA,OAAA,EAAS,YAAM;AACxC;AACA,WAAOC,KAAAA,CAAAA,WAAAA,IAAqB,IAAIC,aAAAA,CAAJ,OAAA,CAA5B,KAA4B,CAA5B;AAFyB,GAAA,EAGxB,CAHH,KAGG,CAHwB,CAA3B;;AAF0B,MAAA,SAAA,GAOJ,CAAA,GAAA,MAAA,CAAA,QAAA,EAPI,kBAOJ,CAPI;AAAA,MAAA,UAAA,GAAA,CAAA,GAAA,eAAA,CAAA,OAAA,EAAA,SAAA,EAAA,CAAA,CAAA;AAAA,MAOnBC,WAPmB,GAAA,UAAA,CAAA,CAAA,CAAA;;AAAA,MAAA,UAAA,GAQQ,CAAA,GAAA,MAAA,CAAA,QAAA,EAASA,WAAAA,CARjB,YAQiBA,EAAT,CARR;AAAA,MAAA,UAAA,GAAA,CAAA,GAAA,eAAA,CAAA,OAAA,EAAA,UAAA,EAAA,CAAA,CAAA;AAAA,MAQnBC,SARmB,GAAA,UAAA,CAAA,CAAA,CAAA;AAAA,MAQRC,YARQ,GAAA,UAAA,CAAA,CAAA,CAAA;;AAU1B,GAAA,GAAA,MAAA,CAAA,SAAA,EAAW,YAAM;AACf,QAAMC,KAAAA,GAAQ,WAAA,CAAA,EAAA,CAAA,iBAAA,EAAkC,YAAM;AACpDD,MAAAA,YAAAA,CAAaF,WAAAA,CAAbE,YAAaF,EAAbE,CAAAA;AADF,KAAc,CAAd;;AAIA,QAAI,CAACF,WAAAA,CAAAA,SAAAA,CAAAA,KAAAA,CAAL,eAAKA,EAAL,EAAoD;AAClD;AACAA,MAAAA,WAAAA,CAAAA,eAAAA;AACD;;AACD,WAAA,KAAA;AATF,GAAA,EAUG,CAVH,WAUG,CAVH;AAYA,SACE,OAAA,CAAA,OAAA,CAAA,aAAA,CAAC,aAAA,CAAD,OAAC,CAAD,QAAA,EAAA;AAAsB,IAAA,KAAA,EAAQ;AAAEA,MAAAA,WAAAA,EAAF,WAAA;AAAeC,MAAAA,SAAAA,EAA7C;AAA8B;AAA9B,GAAA,EACGH,KAAAA,CAAMM,QADT,CADF;AAtBF,CAAA;AAhBA;;;;;;;;;;;;;kBA6CeR,Q","sourcesContent":["/*\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport React, { useState, useEffect, useMemo } from 'react';\nimport AuthService from './AuthService';\nimport OktaContext from './OktaContext';\n\nconst Security = (props) => { \n\n  const initialAuthService = useMemo( () => { \n    // don't keep spawning new service instances if this component rerenders\n    return props.authService || new AuthService(props);\n  }, [ props ]);\n\n  const [authService] = useState( initialAuthService );\n  const [authState, setAuthState] = useState(authService.getAuthState());\n  \n  useEffect( () => { \n    const unsub = authService.on('authStateChange', () => {\n      setAuthState(authService.getAuthState());\n    });\n\n    if (!authService._oktaAuth.token.isLoginRedirect()) {\n      // Trigger an initial change event to make sure authState is latest when not in loginRedirect state\n      authService.updateAuthState(); \n    }\n    return unsub;\n  }, [authService]);\n\n  return (\n    <OktaContext.Provider value={ { authService, authState } }>\n      {props.children}\n    </OktaContext.Provider>\n  );\n};\n\nexport default Security;\n"]},"metadata":{},"sourceType":"script"}